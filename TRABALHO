.data
msg:       .asciiz "Digite um número: "       # mensagem de entrada
msg2:      .asciiz "\nVocê digitou: "         # mensagem de saída
buffer:    .space 20                          # espaço para armazenar o texto digitado
resultado: .word 0                            # variável para guardar o número convertido

.text
.globl main
main:
    # --- Exibe mensagem de entrada ---
    li $v0, 4
    la $a0, msg
    syscall

    # --- Lê a string digitada ---
    li $v0, 8
    la $a0, buffer
    li $a1, 20
    syscall

    # --- Inicializações ---
    la $t0, buffer      # ponteiro para a string
    li $t1, 0           # acumulador do número final
    li $t2, 0           # registrador temporário (para o caractere)
    li $t3, 10          # base decimal

loop:
    lb $t2, 0($t0)       # lê próximo caractere

    # --- verifica fim da string ou quebra de linha ---
    beq $t2, 10, fim     # se for '\n' (ASCII 10), fim
    beq $t2, 0, fim      # se for terminador nulo '\0', fim
    beq $t2, 13, fim     # se for carriage return '\r', fim

    # --- verifica se é dígito válido ---
    li $t4, 48           # '0'
    li $t5, 57           # '9'
    blt $t2, $t4, fim
    bgt $t2, $t5, fim

    # --- converte caractere em número e acumula ---
    addi $t2, $t2, -48   # converte de ASCII para inteiro
    mul $t1, $t1, $t3    # desloca casa decimal
    add $t1, $t1, $t2    # adiciona novo dígito

    addi $t0, $t0, 1     # avança para o próximo caractere
    j loop

fim:
    sw $t1, resultado    # guarda o resultado convertido

    # --- mostra resultado ---
    li $v0, 4
    la $a0, msg2
    syscall

    lw $a0, resultado
    li $v0, 1
    syscall

    # --- encerra o programa ---
    li $v0, 10
    syscall
